<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Kalkulator</title>
<style>
    body {
    font-family: Arial;
    background:#f3f3f3;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    }

    .calc {
    background:#fff;
    padding:20px;
    border-radius:15px;
    box-shadow:0 0 10px rgba(0,0,0,0.2);
    width:220px;
    text-align:center;
    }

    input {
    width:90%;
    padding:10px;
    font-size:18px;
    text-align:right;
    margin-bottom:10px;
    }

    .buttons {
    display:grid;
    grid-template-columns:repeat(4,50px);
    gap:5px;
    justify-content:center;
    }

    button {
    width:50px;
    height:50px;
    font-size:18px;
    border:none;
    border-radius:5px;
    background:#40BF19;
    color:white;
    cursor:pointer;
    }

    button:hover {
    background:#005a9e;
    }

    .clear-btn {
    background:#d9534f;
    grid-column: span 4;
    }
    .clear-btn:hover {
    background:#c9302c;
    }
</style>
</head>
<body>
<div class="calc">
    <input type="text" id="expression" placeholder="Wpisz działanie">
    <div class="buttons">
        <button onclick="insert('7')">7</button>
        <button onclick="insert('8')">8</button>
        <button onclick="insert('9')">9</button>
        <button onclick="insert('+')">+</button>
        <button onclick="insert('4')">4</button>
        <button onclick="insert('5')">5</button>
        <button onclick="insert('6')">6</button>
        <button onclick="insert('-')">-</button>
        <button onclick="insert('1')">1</button>
        <button onclick="insert('2')">2</button>
        <button onclick="insert('3')">3</button>
        <button onclick="insert('*')">*</button>
        <button onclick="insert('0')">0</button>
        <button onclick="insert('.')">.</button>
        <button onclick="calculate()">=</button>
        <button onclick="insert('/')">/</button>
        <button class="clear-btn" onclick="clearInput()">C</button>
    </div>
</div>

<script>
const exprField = document.getElementById("expression");

exprField.addEventListener("input", () => {
    if (exprField.dataset.lastResult) {
        exprField.dataset.lastResult = "";
    }
});

function insert(char) {
    if (exprField.dataset.lastResult) {
        exprField.value = "";
        exprField.dataset.lastResult = "";
    }
    exprField.value += char;
}

function calculate() {
    fetch("/calculate", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ expression: exprField.value })
    })
    .then(res => res.json())
    .then(data => {
        exprField.value = data.result;
        exprField.dataset.lastResult = "true";
    })
    .catch(() => exprField.value = "Błąd");
}

function clearInput() {
    exprField.value = "";
    exprField.dataset.lastResult = "";
}

exprField.addEventListener("keypress", function(e){
    if(e.key === "Enter"){
        calculate();
        e.preventDefault();
    }
});
</script>
</body>
</html>
